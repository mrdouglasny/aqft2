# Kolmogorov Extension Theorem — Summary of the Lean Development

This note summarizes the Kolmogorov extension theorem formalization you added to this workspace, based on:
- Manuscript: `proof_outline.tex`
- Lean code: `KolmogorovExtension4/*.lean`

It also explains how to apply it to construct the Gaussian Free Field (GFF) from consistent finite-dimensional marginals.

---

## High-level idea
Given a family of finite-dimensional distributions indexed by finite sets of coordinates (times, indices), if these distributions are projectively consistent (marginals agree under projection), then there exists a measure on the countable/uncountable product space whose finite-dimensional marginals coincide with the given ones. This is Kolmogorov’s extension theorem (aka Daniell–Kolmogorov).

The formalization proceeds by:
1) Building a “content” on cylinder sets from the finite-dimensional measures,
2) Proving regularity (inner regularity w.r.t. compact closed sets) to control additivity,
3) Using a Carathéodory-style measure extension on the semiring of cylinders to get a measure on the σ-algebra generated by cylinders,
4) Verifying that the resulting measure has the desired finite-dimensional marginals and is unique among projective limits.

---

## What the Lean code provides
Files in `KolmogorovExtension4/`:
- `AuxLemmas.lean`, `Semiring.lean`: set-system and semiring infrastructure used to work on cylinders effectively.
- `RegularContent.lean`: Carathéodory extension from an additive content on a semiring to a measure, under regularity hypotheses.
- `CompactSystem.lean`: closed/compact cylinder systems and inner regularity tools.
- `IndependentFamily.lean`: auxiliary probability constructions (not central here).
- `KolmogorovExtension.lean`: the main theorem — constructs the projective limit measure from a projective family.

Key imports from mathlib used by the development include: projective family content, measures regular w.r.t. compacts, and outer-measure machinery.

---

## Core Lean API (names and statements)
The following lives in `KolmogorovExtension4/KolmogorovExtension.lean` inside namespace `MeasureTheory`.

Let `ι` be an index type, and `(α i)` a family of measurable spaces. For each finite `J : Finset ι`, suppose we have a measure `P J` on the finite product `Π j : J, α j`.

- Projective family assumption (from mathlib):
  - `IsProjectiveMeasureFamily P`: compatibility of marginals under restriction maps (`J.restrict`).

- Regularity hypothesis (general inner-regular version):
  - For each `J`, `(P J).InnerRegularWRT (fun s ↦ IsCompact s ∧ IsClosed s) MeasurableSet`.
  - This is later specialized to Polish spaces, where such inner regularity is automatic for finite measures.

- Content on cylinders and σ-additivity under inner regularity:
  - `projectiveFamilyContent hP : Set (Π i, α i) → ℝ≥0∞`.
  - `projectiveFamilyContent_sigma_additive_of_innerRegular …`: σ-additivity on disjoint unions of measurable cylinders using compact-closed inner regularity.

- Carathéodory extension to a measure on the σ-algebra generated by measurable cylinders:
  - In general metric-like setting (pseudo-EMetric + Borel + second countable + complete):
    
    ```lean
    noncomputable def projectiveLimitWithWeakestHypotheses …
      (hP : IsProjectiveMeasureFamily P) : Measure (Π i, α i)
    ```

  - In Polish spaces (topological, Borel, separable complete metric) with finite marginals:
    
    ```lean
    noncomputable def projectiveLimit (P) [∀ i, IsFiniteMeasure (P i)]
      (hP : IsProjectiveMeasureFamily P) : Measure (Π i, α i)
    ```

- Correctness and uniqueness of the projective limit:
  - `isProjectiveLimit_projectiveLimit (hP) : IsProjectiveLimit (projectiveLimit P hP) P`
  - Instances: 
    - `IsFiniteMeasure (projectiveLimit P hP)`
    - `IsProbabilityMeasure (projectiveLimit P hP)` when all `P i` are probabilities and `ι` is nonempty.

These show that the constructed measure on the product has exactly the prescribed finite-dimensional marginals.

---

## Outline of the manuscript (`proof_outline.tex`)
The paper documents the mathematical backbone and design choices:

1) Topological and measurable structure
   - Works with pseudo-metrics, uniform spaces, and Borel σ-algebras.
   - Targets Polish spaces (separable, complete metric) but abstracts to inner-regular finite measures.

2) Set systems and contents
   - Semi-rings (of sets) and additive contents (finitely additive set functions) are introduced and formalized.
   - Cylinders over finite index sets form the semiring used for the construction.

3) Inner regularity and compacts
   - For a single finite measure on a Polish space, inner regularity w.r.t. compact closed sets is established (or assumed in the general version). This is crucial for proving σ-additivity of the content on a countable disjoint union of cylinders.

4) Carathéodory extension theorem
   - Extends an additive content defined on a semiring (measurable cylinders) to a bona fide measure on the σ-algebra generated by the semiring.

5) Kolmogorov extension theorem
   - Given a projective family `(P J)` on finite products with the compatibility property, define the cylinder content via pushforwards and extend it to a measure on the product σ-algebra. Show it has the right marginals and is unique.

6) Applications and future work
   - Instances: product probability measures with arbitrary index sets; paths to stochastic processes (Poisson, Brownian motion), and direction toward Ionescu–Tulcea.

---

## How to use it for the GFF in this project
Goal: Construct a probability measure on a space of generalized fields (distributions) whose finite-dimensional marginals are Gaussian with covariance given by the free covariance form.

Concrete steps:
1) Choose target spaces per coordinate:
   - Coordinates are evaluations against a finite family `(f₁,…,fₙ)` of real Schwartz test functions (or their images in a separable Hilbert space). Each coordinate space can be `ℝ` (Polish).

2) Define finite-dimensional marginals `P J`:
   - For `J ⊆ₑ finite`, define the Gaussian measure on `Π j∈J, ℝ` with mean 0 and covariance matrix Σ with entries `Σ(i,j) = freeCovarianceFormR m (f_i) (f_j)`.
   - This uses the well-known existence of multivariate normal measures on `ℝ^n` and the positive semidefiniteness of Σ (from your `Covariance.lean` framework).

3) Check projectivity (consistency):
   - If `H ⊆ J`, the marginal of `P J` on the coordinates in `H` equals `P H`. For Gaussians, this is standard: projection of a centered Gaussian is centered Gaussian with the corresponding submatrix covariance.

4) Apply the theorem:
   - Assemble `P : ∀ J, Measure (Π j:J, ℝ)` and prove `IsProjectiveMeasureFamily P`.
   - Use `projectiveLimit P hP` (Polish version) to obtain a measure on the product `Π i, ℝ` (or on a distribution space obtained as an image if you bundle the evaluation coordinates appropriately).

5) Push forward to the field configuration space (if needed):
   - If you model the field as a random linear functional `ω`, push forward the Kolmogorov product measure along the map that sends a product point to the linear functional on test functions. One then verifies that the characteristic functional is `exp(−½ ⟨f, C f⟩)`.

Remarks:
- On `ℝ^d`, the free field is distribution-valued and not an `L²` random series of plane waves. The Kolmogorov approach is the canonical way to build it globally without UV/IR cutoffs.
- Your existing `Covariance.lean` provides positivity and Fourier representations that justify Gaussianity and consistency of the finite-dimensional covariances.

---

## Quick reference to main Lean names
- Projective family condition: `IsProjectiveMeasureFamily`
- Cylinder systems: `measurableCylinders`, `closedCompactCylinders`, `cylinder`
- Content: `projectiveFamilyContent`
- Extension (general): `projectiveLimitWithWeakestHypotheses`
- Extension (Polish): `projectiveLimit`
- Correctness: `isProjectiveLimit_projectiveLimit`

These are the entry points to wire your Gaussian marginals into an actual infinite product probability measure.
